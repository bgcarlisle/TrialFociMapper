# TrialFociMapper

## Description
All [ClinicalTrials.gov](https://classic.clinicaltrials.gov/) data is available in the ctgov schema of the [AACT database](https://aact.ctti-clinicaltrials.org/). The Browse Conditions table in the AACT database contains the 'Browse conditions' table for conditions studied in the trial, with the column "mesh_type" indicating whether the term is a leaf identified as "mesh-list" or an ancestor identified as "mesh-ancestor". 

When data submitters provide information to ClinicalTrials.gov about a study, they are encouraged to use Medical Subject Heading (MeSH) terminology for conditions, interventions and keywords. The browse_conditions table contains MeSH terms generated by an algorithm run by the National Library of Medicine (NLM). The NLM algorithm is run nightly on all studies in the ClinicalTrials.gov database and sources the most up-to-date information from the study record. Earlier versions of the data did not include the full MeSH hierarchy, but studies now contain the full hierarchy.

The TrialFociMapper package retrieves the browse_conditions table for a given trial and assigns major MeSH headings using the [NLM descriptor data](https://nlmpubs.nlm.nih.gov/projects/mesh/MESH_FILES/meshtrees/) as a reference. It leverages the information provided by data submitters to ClinicalTrials.gov and uses the `generate_foci` function to generate major foci for each trial. Additionally, since a single trial can have more than one Major MeSH Heading, the `assign_therapeutic_foci` function is available to analyze and assign a single therapeutic focus to a trial using a disease-centric approach.

### What is a disease-centric approach?
The disease-centric approach prioritizes diseases as the main factor in determining the therapeutic focus. Higher weights are assigned to diseases and associated organ systems, pathology, 
or symptoms are given lesser weight. These Major MeSH headings are taken from category "C" representing 'diseases' from [MeSH descriptors data 2023](https://www.nlm.nih.gov/databases/download/mesh.html). Medical Subject Headings (MeSH) is a hierarchically-organized terminology for indexing and cataloguing of biomedical information used by data-submitters to describe the conditions studies in the trial.

Following is the table of MeSH heading with corresponding weights:
 | Major MeSH Heading | Weight |
 |-----|------|
 |Infections| 4|
 |Neoplasms| 3|
 |Cardiovascular Diseases| 2.5|
 |Nervous System Diseases| 2.5|
 |Musculoskeletal Diseases|2|
 |Digestive System Diseases|2|
 |Respiratory Tract Diseases|2|
 |Otorhinolaryngologic Diseases|2|
 |Eye Diseases|2|
 |Urogenital Diseases|2|
 |Hemic and Lymphatic Diseases|2|
 |Congenital, Hereditary, and Neonatal Diseases and Abnormalities|2|
 |Skin and Connective Tissue Diseases|2|
 |Nutritional and Metabolic Diseases|2|
 |Endocrine System Diseases|2|
 |Immune System Diseases|2|
 |Disorders of Environmental Origin|2|
 |Animal Diseases|2|
 |Pathological Conditions, Signs and Symptoms|1.5|
 |Stomatognathic Diseases|1.5|
 |Occupational Diseases|1|
 |Chemically-Induced Disorders|1|
 |Wounds and Injuries |1|

source: https://meshb.nlm.nih.gov/treeView

### Note
ðŸ”º In cases where no information is submitted from the data submitters for a particular clinical trial, the function will assign "NA" as the therapeutic focus.

ðŸ”º If a trial is assigned with all Major MeSH headings with the same weight, the first mentioned 'Major MeSH Heading' is assigned as a therapeutic focus.

## How to install
To install the package, you will need to install devtools first, and then install via git:
```R
install.packages("devtools")
library(devtools)
install_github("sama9767/TrialFociMapper")
library(TrialFociMapper)
````

## TrialFoci functions
This package provides two functions:

1. `generate_foci` -  Retrieve trial foci and assign major MeSH headings

Note: An account in the AACT database is required for generating a username and password (see link: https://aact.ctti-clinicaltrials.org/users/sign_up)
```R
generate_foci(nctids, username, password)
data <- generate_foci("NCT01271322",username, password)
````

|  nct_id | major_mesh_heading_1   |   major_mesh_heading_2 | major_mesh_heading_3| major_mesh_heading_4|
|---------|-----------|---------|-----|------------|
|   NCT01271322  |     Neoplasms         | Digestive System Diseases | NA |NA|

2. `assign_therapeutic_focus` - (Assigns a single therapeutic focus to each clinical trial based on disease centric approach
```R
assign_therapeutic_focus(data, "nct_id", c("major_mesh_heading_1", "major_mesh_heading_2",  "major_mesh_heading_3", "major_mesh_heading_4")
`````
|  nct_id | major_mesh_heading_1   |   major_mesh_heading_2 | major_mesh_heading_3| major_mesh_heading_4| therapeutic_focus|
|---------|-----------|---------|-----|------------|----|
|   NCT01271322  |     Neoplasms         | Digestive System Diseases | NA |NA| Neoplasm|

 
